<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ - The Carpetmaker</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --purple-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --text-dark: #1f2933;
      --text-light: #7b8794;
      --border: #e1e7ef;
      --section-border: #4f46e5;
      --success: #10b981;
      --danger: #ef4444;
    }

    body {
      font-family: 'Sarabun', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--purple-gradient);
      min-height: 100vh;
      padding: 32px 16px;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 24px;
      color: #fff;
    }

    .header-title {
      font-size: 32px;
      font-weight: 700;
      text-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
    }

    .header-subtitle {
      margin-top: 4px;
      font-size: 14px;
      opacity: 0.9;
    }

    .content {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 20px;
    }

    .card {
      background: #fff;
      border-radius: 20px;
      padding: 24px 28px 28px;
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.35);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: var(--purple-gradient);
    }

    .card-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-dark);
      margin-bottom: 16px;
    }

    /* SECTION FRAME */
    .section {
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px 18px 18px;
      margin-bottom: 14px;
      background: #f9fafb;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
    }

    .section-bar {
      width: 4px;
      height: 20px;
      border-radius: 999px;
      background: var(--section-border);
    }

    .section-title {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-dark);
    }

    .field-grid {
      display: grid;
      grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
      gap: 10px 18px;
    }

    .field {
      font-size: 13px;
    }

    .field-label {
      font-size: 12px;
      color: var(--text-light);
      margin-bottom: 3px;
    }

    .field-value-box {
      min-height: 34px;
      border-radius: 8px;
      border: 1px solid var(--border);
      padding: 6px 10px;
      background: #fff;
      display: flex;
      align-items: center;
      font-size: 13px;
      color: var(--text-dark);
      white-space: pre-wrap;
    }

    .status-msg {
      font-size: 13px;
      padding: 8px 10px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 12px;
      background: #eff6ff;
      color: #1d4ed8;
    }

    .status-msg.error {
      background: #fef2f2;
      color: #b91c1c;
    }
    .status-msg.success {
      background: #ecfdf5;
      color: #047857;
    }

    /* ===== ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (‡πÉ‡∏´‡∏°‡πà) ===== */

    .operation-note {
      font-size: 12px;
      color: var(--text-light);
      margin-bottom: 8px;
    }

    .operation-row {
      display: grid;
      grid-template-columns: auto minmax(0, 1fr);
      gap: 4px 10px;
      padding: 4px 0;
    }

    .operation-left {
      display: flex;
      align-items: flex-start;
      gap: 6px;
      font-size: 13px;
      color: var(--text-dark);
      min-width: 140px;
    }

    .operation-left input[type="radio"] {
      margin-top: 3px;
    }

    .operation-right {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .op-line {
      display: flex;
      align-items: flex-end;   /* ‡πÉ‡∏´‡πâ‡πÄ‡∏™‡πâ‡∏ô‡πÑ‡∏õ‡∏≠‡∏¢‡∏π‡πà‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î */
      gap: 6px;
    }

    .op-label {
      font-size: 13px;
      color: var(--text-dark);
      white-space: nowrap;
    }

    .readonly-line {
      display: inline-block;
      flex: 1;
      min-height: 18px;
      border-bottom: 1px solid #cbd5e1;
      padding: 0 4px 2px;      /* ‡πÄ‡∏ô‡πâ‡∏ô padding ‡∏•‡πà‡∏≤‡∏á */
      font-size: 13px;
      color: var(--text-dark);
      line-height: 1.3;
      vertical-align: bottom;
    }

    .operation-detail-wrapper {
      margin-top: 10px;
      font-size: 13px;
    }

    .operation-detail-label {
      margin-bottom: 4px;
      color: var(--text-light);
    }

    .textarea-box {
      border-radius: 10px;
      border: 1px solid var(--border);
      padding: 8px 10px;
      background: #ffffff;
      min-height: 80px;
      font-size: 13px;
      color: var(--text-dark);
      white-space: pre-wrap;
    }

    /* ===== ‡∏ù‡∏±‡πà‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô ===== */

    .signature-pad {
      border: 2px dashed var(--border);
      border-radius: 10px;
      background: #ffffff;
      cursor: crosshair;
      display: block;
      width: 100%;
      margin: 8px 0 12px;
    }

    .btn-row {
      display: flex;
      gap: 10px;
      margin-bottom: 16px;
    }

    .btn {
      flex: 1;
      padding: 10px 14px;
      border-radius: 999px;
      border: none;
      font-family: inherit;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .btn-clear {
      background: #e5e7eb;
      color: #374151;
    }
    .btn-clear:hover {
      background: #d1d5db;
    }

    .btn-save {
      background: var(--success);
      color: #ffffff;
      box-shadow: 0 4px 14px rgba(16, 185, 129, 0.35);
    }
    .btn-save:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(16, 185, 129, 0.45);
    }

    .info-item {
      padding: 10px 12px;
      border-radius: 10px;
      background: #f9fafb;
      border: 1px solid #edf2f7;
      font-size: 13px;
      margin-bottom: 8px;
    }
    .info-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .04em;
      color: var(--text-light);
      margin-bottom: 2px;
    }

    @media (max-width: 900px) {
      .content { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1 class="header-title">‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h1>
      <p class="header-subtitle">
        ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏£‡∏≠‡∏Å‡πÑ‡∏ß‡πâ ‡πÅ‡∏•‡∏∞‡∏•‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå (e-Signature)
      </p>
    </div>

    <div class="content">
      <!-- ‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ï -->
      <div class="card">
        <div class="card-title">üìÑ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>

        <div id="status" class="status-msg">
          ‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö...
        </div>

        <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô -->
        <div class="section">
          <div class="section-header">
            <div class="section-bar"></div>
            <div class="section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
          </div>

          <div class="field-grid">
            <div class="field">
              <div class="field-label">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</div>
              <div class="field-value-box" id="empName">-</div>
            </div>
            <div class="field">
              <div class="field-label">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô / ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</div>
              <div class="field-value-box" id="empCodePos">-</div>
            </div>
            <div class="field">
              <div class="field-label">‡πÅ‡∏ú‡∏ô‡∏Å / ‡∏ù‡πà‡∏≤‡∏¢</div>
              <div class="field-value-box" id="dept">-</div>
            </div>
            <div class="field">
              <div class="field-label">‡∏™‡∏†‡∏≤‡∏û‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô / ‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</div>
              <div class="field-value-box" id="employmentStatus">-</div>
            </div>
          </div>
        </div>

        <!-- ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (layout ‡πÅ‡∏ö‡∏ö Google Form) -->
        <div class="section">
          <div class="section-header">
            <div class="section-bar"></div>
            <div class="section-title">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
          </div>

          <div class="operation-note">
            * ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ß‡πâ‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö (‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)
          </div>

          <!-- ‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á -->
          <div class="operation-row">
            <div class="operation-left">
              <input type="radio" name="actionType" id="action_appoint" disabled>
              <label for="action_appoint">‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á</label>
            </div>
            <div class="operation-right">
              <div class="op-line">
                <span class="op-label">‡πÄ‡∏õ‡πá‡∏ô</span>
                <span class="readonly-line" id="appoint_to"></span>
              </div>
            </div>
          </div>

          <!-- ‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢ -->
          <div class="operation-row">
            <div class="operation-left">
              <input type="radio" name="actionType" id="action_transfer" disabled>
              <label for="action_transfer">‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢</label>
            </div>
            <div class="operation-right">
              <div class="op-line">
                <span class="op-label">‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°</span>
                <span class="readonly-line" id="transfer_from"></span>
              </div>
              <div class="op-line">
                <span class="op-label">‡πÄ‡∏õ‡πá‡∏ô</span>
                <span class="readonly-line" id="transfer_to"></span>
              </div>
            </div>
          </div>

          <!-- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô -->
          <div class="operation-row">
            <div class="operation-left">
              <input type="radio" name="actionType" id="action_change" disabled>
              <label for="action_change">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô</label>
            </div>
            <div class="operation-right">
              <div class="op-line">
                <span class="op-label">‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°</span>
                <span class="readonly-line" id="change_from"></span>
              </div>
              <div class="op-line">
                <span class="op-label">‡πÄ‡∏õ‡πá‡∏ô</span>
                <span class="readonly-line" id="change_to"></span>
              </div>
            </div>
          </div>

          <!-- ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á -->
          <div class="operation-row">
            <div class="operation-left">
              <input type="radio" name="actionType" id="action_promote" disabled>
              <label for="action_promote">‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
            </div>
            <div class="operation-right">
              <div class="op-line">
                <span class="op-label">‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°</span>
                <span class="readonly-line" id="promote_from"></span>
              </div>
              <div class="op-line">
                <span class="op-label">‡πÄ‡∏õ‡πá‡∏ô</span>
                <span class="readonly-line" id="promote_to"></span>
              </div>
            </div>
          </div>

          <!-- ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏á‡∏≤‡∏ô -->
          <div class="operation-row">
            <div class="operation-left">
              <input type="radio" name="actionType" id="action_passProb" disabled>
              <label for="action_passProb">‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏á‡∏≤‡∏ô</label>
            </div>
            <div class="operation-right">
              <div class="op-line">
                <span class="op-label">‡πÄ‡∏õ‡πá‡∏ô</span>
                <span class="readonly-line" id="passProb_to"></span>
              </div>
            </div>
          </div>

          <!-- ‡πÉ‡∏´‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô / ‡∏•‡∏≤‡∏≠‡∏≠‡∏Å -->
          <div class="operation-row">
            <div class="operation-left">
              <input type="radio" name="actionType" id="action_terminate" disabled>
              <label for="action_terminate">‡πÉ‡∏´‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô / ‡∏•‡∏≤‡∏≠‡∏≠‡∏Å</label>
            </div>
            <div class="operation-right">
              <div class="op-line">
                <span class="op-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</span>
                <span class="readonly-line" id="terminate_detail"></span>
              </div>
            </div>
          </div>

          <!-- ‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á / ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô -->
          <div class="operation-row">
            <div class="operation-left">
              <input type="radio" name="actionType" id="action_raise" disabled>
              <label for="action_raise">‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á / ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</label>
            </div>
            <div class="operation-right">
              <div class="op-line">
                <span class="op-label">‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°</span>
                <span class="readonly-line" id="raise_from"></span>
              </div>
              <div class="op-line">
                <span class="op-label">‡πÄ‡∏õ‡πá‡∏ô</span>
                <span class="readonly-line" id="raise_to"></span>
              </div>
            </div>
          </div>

          <!-- ‡∏ï‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á / ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô -->
          <div class="operation-row">
            <div class="operation-left">
              <input type="radio" name="actionType" id="action_cut" disabled>
              <label for="action_cut">‡∏ï‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á / ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</label>
            </div>
            <div class="operation-right">
              <div class="op-line">
                <span class="op-label">‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°</span>
                <span class="readonly-line" id="cut_from"></span>
              </div>
              <div class="op-line">
                <span class="op-label">‡πÄ‡∏õ‡πá‡∏ô</span>
                <span class="readonly-line" id="cut_to"></span>
              </div>
            </div>
          </div>

          <!-- ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ -->
          <div class="operation-row">
            <div class="operation-left">
              <input type="radio" name="actionType" id="action_other" disabled>
              <label for="action_other">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</label>
            </div>
            <div class="operation-right">
              <div class="op-line">
                <span class="op-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</span>
                <span class="readonly-line" id="other_detail"></span>
              </div>
            </div>
          </div>

          <!-- ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏ß‡∏° / ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏• (‡πÉ‡∏ä‡πâ id ‡πÄ‡∏î‡∏¥‡∏°) -->
          <div class="operation-detail-wrapper">
            <div class="operation-detail-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£:</div>
            <div class="textarea-box" id="detailText">-</div>
          </div>

          <div class="operation-detail-wrapper" style="margin-top:8px;">
            <div class="operation-detail-label">‡∏°‡∏µ‡∏ú‡∏•‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</div>
            <div class="readonly-line" id="effectiveDate"></div>
          </div>
        </div>
      </div>

      <!-- ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤: ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô -->
      <div class="card">
        <div class="card-title">‚úçÔ∏è ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô</div>

        <div class="info-item">
          <div class="info-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</div>
          <div>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‚Äú‡πÄ‡∏ã‡πá‡∏ô‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö ‚Äù ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</div>
        </div>

        <canvas id="signaturePad" class="signature-pad" height="170"></canvas>

        <div class="btn-row">
          <button type="button" class="btn btn-clear" onclick="clearSignature()">
            ‚úï ‡∏•‡πâ‡∏≤‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô
          </button>
          <button type="button" class="btn btn-save" onclick="saveSignature()">
            üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô
          </button>
        </div>

        <div class="info-item">
          <div class="info-label">‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</div>
          <div id="docIdDisplay">-</div>
        </div>

        <div class="info-item">
          <div class="info-label">‡∏ú‡∏π‡πâ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô</div>
          <div id="reviewerNameDisplay">‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡∏¢</div>
        </div>

        <div style="font-size: 11px; color: var(--text-light); margin-top: 6px;">
          ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ ‡πÇ‡∏î‡∏¢‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå <code>?id=...</code> ‡πÉ‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå
        </div>
      </div>
    </div>
  </div>

  <script>
    // ================================
    // CONFIG
    // ================================
    const WEB_APP_URL =
      'https://script.google.com/macros/s/AKfycbxe3OSwY-ko4E3qvVSyFQQ1W7OCZjufP-VmFT3LxPqFMwf_y8LO9A8cxFJjMvHvdj7ksQ/exec';

    // ================================
    // Helper: ‡∏≠‡πà‡∏≤‡∏ô query string
    // ================================
    function getQueryParam(name) {
      const url = new URL(window.location.href);
      return url.searchParams.get(name) || '';
    }

    // ================================
    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet (‡∏ú‡πà‡∏≤‡∏ô Apps Script JSONP)
    // ================================
    function loadOperationData() {
      const id = getQueryParam('id') || getQueryParam('row') || '';
      const statusEl = document.getElementById('status');
      const docIdDisplay = document.getElementById('docIdDisplay');
      const reviewerName = getQueryParam('reviewer') || '';

      if (docIdDisplay) docIdDisplay.textContent = id || '-';
      if (reviewerName) {
        const r = document.getElementById('reviewerNameDisplay');
        if (r) r.textContent = reviewerName;
      }

      if (!id) {
        statusEl.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ ?id=xxxx)';
        statusEl.classList.add('error');
        return;
      }

      statusEl.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö...';
      statusEl.classList.remove('error', 'success');

      const callbackName = 'opCallback_' + Date.now();

      window[callbackName] = function(result) {
        console.log('operation data:', result);
        if (result && result.success && result.data) {
          renderOperationData(result.data);
          statusEl.textContent = '‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
          statusEl.classList.add('success');
          setTimeout(() => { statusEl.style.display = 'none'; }, 2500);
        } else {
          statusEl.textContent = '‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ';
          statusEl.classList.add('error');
        }
        cleanupJSONP(callbackName);
      };

      const script = document.createElement('script');
      script.src =
        WEB_APP_URL +
        '?action=getOperationData' +
        '&id=' + encodeURIComponent(id) +
        '&callback=' + callbackName;

      script.onerror = function() {
        statusEl.textContent = '‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠';
        statusEl.classList.add('error');
        cleanupJSONP(callbackName);
      };

      document.head.appendChild(script);
    }

    function cleanupJSONP(callbackName) {
      try {
        const scripts = document.getElementsByTagName('script');
        for (let i = scripts.length - 1; i >= 0; i--) {
          if (scripts[i].src && scripts[i].src.includes(callbackName)) {
            scripts[i].parentNode.removeChild(scripts[i]);
          }
        }
      } catch (e) {}
      delete window[callbackName];
    }

    // ================================
    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏´‡∏ô‡πâ‡∏≤ HTML (‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
    // *** ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏Å‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ map field ‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ï‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á ‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°/‡πÄ‡∏õ‡πá‡∏ô ‡πÑ‡∏î‡πâ ***
    // ================================
    function renderOperationData(data) {
      document.getElementById('empName').textContent =
        data['‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô'] || data['employeeName'] || '-';

      document.getElementById('empCodePos').textContent =
        data['‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô/‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á'] || data['empCodePosition'] || '-';

      document.getElementById('dept').textContent =
        data['‡πÅ‡∏ú‡∏ô‡∏Å/‡∏ù‡πà‡∏≤‡∏¢'] || data['department'] || '-';

      document.getElementById('employmentStatus').textContent =
        data['‡∏™‡∏†‡∏≤‡∏û‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô/‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô'] || data['employmentStatus'] || '-';

      const actionType = data['‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£'] || data['actionType'] || '';

      const radioMap = {
        '‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á': 'action_appoint',
        '‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢': 'action_transfer',
        '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô': 'action_change',
        '‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á': 'action_promote',
        '‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏á‡∏≤‡∏ô': 'action_passProb',
        '‡πÉ‡∏´‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏à / ‡∏•‡∏≤‡∏≠‡∏≠‡∏Å': 'action_terminate',
        '‡πÉ‡∏´‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏à/‡∏•‡∏≤‡∏≠‡∏≠‡∏Å': 'action_terminate',
        '‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á / ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô': 'action_raise',
        '‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á/‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô': 'action_raise',
        '‡∏ï‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á / ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô': 'action_cut',
        '‡∏ï‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á/‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô': 'action_cut',
        '‡∏≠‡∏∑‡πà‡∏ô ‡πÜ': 'action_other',
        '‡∏≠‡∏∑‡πà‡∏ô‡πÜ': 'action_other'
      };

      const radioId = radioMap[actionType];
      if (radioId) {
        const r = document.getElementById(radioId);
        if (r) r.checked = true;
      }

      // ‚≠ê ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á mapping ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏µ‡∏ï ‚Üí ‡∏ä‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°/‡πÄ‡∏õ‡πá‡∏ô
      // ‡πÄ‡∏Å‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠ key ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏´‡∏±‡∏ß‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
      document.getElementById('appoint_to').textContent =
        data['‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á_‡πÄ‡∏õ‡πá‡∏ô'] || '';

      document.getElementById('transfer_from').textContent =
        data['‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢_‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°'] || '';
      document.getElementById('transfer_to').textContent =
        data['‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢_‡πÄ‡∏õ‡πá‡∏ô'] || '';

      document.getElementById('change_from').textContent =
        data['‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏†‡∏≤‡∏û_‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°'] || '';
      document.getElementById('change_to').textContent =
        data['‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏†‡∏≤‡∏û_‡πÄ‡∏õ‡πá‡∏ô'] || '';

      document.getElementById('promote_from').textContent =
        data['‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á_‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°'] || '';
      document.getElementById('promote_to').textContent =
        data['‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á_‡πÄ‡∏õ‡πá‡∏ô'] || '';

      document.getElementById('passProb_to').textContent =
        data['‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏á‡∏≤‡∏ô_‡πÄ‡∏õ‡πá‡∏ô'] || '';

      document.getElementById('terminate_detail').textContent =
        data['‡πÉ‡∏´‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô_‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î'] || '';

      document.getElementById('raise_from').textContent =
        data['‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á_‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°'] || '';
      document.getElementById('raise_to').textContent =
        data['‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á_‡πÄ‡∏õ‡πá‡∏ô'] || '';

      document.getElementById('cut_from').textContent =
        data['‡∏ï‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á_‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°'] || '';
      document.getElementById('cut_to').textContent =
        data['‡∏ï‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á_‡πÄ‡∏õ‡πá‡∏ô'] || '';

      document.getElementById('other_detail').textContent =
        data['‡∏≠‡∏∑‡πà‡∏ô‡πÜ_‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î'] || '';

      document.getElementById('detailText').textContent =
        data['‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°'] || data['detail'] || '-';

      document.getElementById('effectiveDate').textContent =
        data['‡∏°‡∏µ‡∏ú‡∏•‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'] || data['effectiveDate'] || '-';
    }

    // ================================
    // ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô (‡∏ú‡∏π‡πâ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô)
    // ================================
    const canvas = document.getElementById('signaturePad');
    const ctx = canvas.getContext('2d');
    let isDrawing = false;
    let hasStroke = false;

    function resizeCanvas() {
      const rect = canvas.getBoundingClientRect();
      canvas.width = rect.width;
      canvas.height = 170;
      ctx.lineWidth = 2;
      ctx.lineCap = 'round';
      ctx.strokeStyle = '#111827';
    }

    function startDraw(e) {
      isDrawing = true;
      hasStroke = true;
      const pos = getPosition(e);
      ctx.beginPath();
      ctx.moveTo(pos.x, pos.y);
    }
    function draw(e) {
      if (!isDrawing) return;
      const pos = getPosition(e);
      ctx.lineTo(pos.x, pos.y);
      ctx.stroke();
    }
    function stopDraw() { isDrawing = false; }

    function getPosition(e) {
      const rect = canvas.getBoundingClientRect();
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;
      return { x: clientX - rect.left, y: clientY - rect.top };
    }

    canvas.addEventListener('mousedown', startDraw);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDraw);
    canvas.addEventListener('mouseleave', stopDraw);

    canvas.addEventListener('touchstart', function(e) { e.preventDefault(); startDraw(e); }, {passive:false});
    canvas.addEventListener('touchmove', function(e) { e.preventDefault(); draw(e); }, {passive:false});
    canvas.addEventListener('touchend', function(e) { e.preventDefault(); stopDraw(e); }, {passive:false});

    function clearSignature() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      hasStroke = false;
    }

    function saveSignature() {
      const id = getQueryParam('id') || '';
      if (!id) {
        alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (id) ‡πÉ‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå');
        return;
      }
      if (!hasStroke) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å');
        return;
      }

      const dataUrl = canvas.toDataURL('image/png');

      const params = new URLSearchParams();
      params.append('action', 'saveReviewerSignature');
      params.append('id', id);
      params.append('signature', dataUrl);

      fetch(WEB_APP_URL, {
        method: 'POST',
        mode: 'no-cors',
        body: params
      })
      .then(() => {
        alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
      })
      .catch(err => {
        console.error(err);
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô: ' + err.message);
      });
    }

    // ================================
    // Init
    // ================================
    window.addEventListener('DOMContentLoaded', () => {
      resizeCanvas();
      loadOperationData();
    });
    window.addEventListener('resize', resizeCanvas);
  </script>
</body>
</html>
