<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --purple-pearl: #3D3B54;
      --purple-pearl-dark: #2F2D45;
      --gold-accent: #B8A068;
      --text-dark: #1A252F;
      --text-light: #5A6C7D;
      --text-light-on-navy: #D4D4D4;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Sarabun', 'Roboto', Arial, sans-serif;
      background: linear-gradient(135deg, #F5F5F5 0%, #EEEEEE 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container { max-width: 760px; margin: 0 auto; }

    .form-header {
      background: linear-gradient(135deg, var(--purple-pearl) 0%, var(--purple-pearl-dark) 100%);
      color: var(--text-light-on-navy);
      padding: 24px;
      border-radius: 8px 8px 0 0;
      margin-bottom: 12px;
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 16px;
      border-bottom: 4px solid var(--gold-accent);
    }

    .form-header h1 {
      font-size: 32px;
      font-weight: 400;
      margin-bottom: 8px;
      font-family: 'Playfair Display', serif;
      letter-spacing: 1px;
    }

    .form-header p { 
      font-size: 14px; 
      opacity: 0.9; 
    }

    .doc-no-box {
      text-align: right;
      font-size: 14px;
      min-width: 90px;
    }

    .doc-no-label { opacity: 0.9; }
    .doc-no-value { font-weight: 600; margin-top: 4px; }

    .question-card {
      background: white;
      border-radius: 8px;
      padding: 24px;
      margin-bottom: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      border-top: 3px solid var(--purple-pearl);
    }

    .question-label {
      font-size: 16px;
      color: var(--text-dark);
      margin-bottom: 8px;
      display: block;
      font-weight: 500;
    }

    .required { 
      color: #d93025; 
      margin-left: 4px; 
    }

    input[type="text"],
    input[type="email"],
    input[type="date"],
    textarea,
    select {
      width: 100%;
      padding: 13px 15px;
      border: none;
      border-bottom: 1px solid #dadce0;
      font-size: 16px;
      font-family: inherit;
      background: transparent;
      transition: border-color 0.2s;
      color: var(--text-dark);
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-bottom: 2px solid var(--purple-pearl);
    }

    input::placeholder,
    textarea::placeholder { 
      color: #80868b; 
    }

    select {
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23202124' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 8px center;
      padding-right: 32px;
    }

    textarea {
      min-height: 100px;
      resize: vertical;
      border: 1px solid #dadce0;
      border-radius: 4px;
      padding: 13px 15px;
    }

    .options-group { margin-top: 16px; }

    .option-item {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      min-height: 32px;
    }

    .option-item input[type="checkbox"],
    .option-item input[type="radio"] {
      width: 20px;
      height: 20px;
      margin-right: 12px;
      cursor: pointer;
      flex-shrink: 0;
      accent-color: var(--purple-pearl);
    }

    .option-item label {
      font-size: 14px;
      color: var(--text-dark);
      cursor: pointer;
      flex: 1;
    }

    .option-item input[type="text"] {
      width: 300px;
      margin-left: 8px;
      padding: 8px 12px;
      border: 1px solid #dadce0;
      border-radius: 4px;
      color: var(--text-dark);
    }

    .signature-section {
      background: #f8f9fa;
      padding: 16px;
      border-radius: 4px;
      margin-top: 16px;
    }

    .signature-section h3 {
      font-size: 16px;
      color: var(--text-dark);
      margin-bottom: 12px;
      font-weight: 500;
    }

    /* ‚úÖ ‡∏õ‡∏£‡∏±‡∏ö canvas ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô review: ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏° + touch-action none */
    canvas {
      border: 2px dashed #dadce0;
      border-radius: 4px;
      cursor: crosshair;
      touch-action: none;
      display: block;
      width: 100%;
      background: white;
      margin: 12px 0;
    }

    .button-group {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    button {
      padding: 10px 24px;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      font-family: inherit;
    }

    .btn-clear {
      background: white;
      color: var(--purple-pearl);
      border: 1px solid #dadce0;
    }

    .btn-clear:hover { 
      background: #f8f9fa;
      border-color: var(--purple-pearl);
    }

    .btn-submit {
      background: linear-gradient(135deg, var(--purple-pearl), var(--purple-pearl-dark));
      color: white;
      padding: 10px 32px;
      box-shadow: 0 4px 12px rgba(61, 59, 84, 0.3);
    }

    .btn-submit:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(61, 59, 84, 0.4);
    }

    button:disabled {
      background: #dadce0 !important;
      color: #80868b !important;
      cursor: not-allowed;
      box-shadow: none;
    }

    #status {
      margin-top: 16px;
      padding: 16px;
      border-radius: 4px;
      display: none;
      font-size: 14px;
      font-weight: 500;
    }

    .success {
      background: #e8f5e9;
      color: #1e7e34;
      border-left: 4px solid #2e7d32;
    }

    .error {
      background: #fce4ec;
      color: #c62828;
      border-left: 4px solid #d32f2f;
    }

    .loading {
      background: #fff3e0;
      color: #e65100;
      border-left: 4px solid #f57c00;
    }

    .spinner {
      display: inline-block;
      width: 14px;
      height: 14px;
      border: 2px solid rgba(0,0,0,.1);
      border-radius: 50%;
      border-top-color: var(--purple-pearl);
      animation: spin 0.8s ease-in-out infinite;
      margin-right: 8px;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    .helper-text {
      font-size: 12px;
      color: var(--text-light);
      margin-top: 8px;
    }

    @media (max-width: 768px) {
      .form-header { flex-direction: column; align-items: flex-start; }
      .form-header h1 { font-size: 24px; }
      .question-card { padding: 16px; }
      .option-item input[type="text"] {
        width: 100%;
        margin-left: 0;
        margin-top: 8px;
      }
      .button-group { flex-direction: column; width: 100%; }
      button { width: 100%; }
      .doc-no-box { align-self: flex-end; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="form-header">
      <div>
        <h1>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®</h1>
        <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏•‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</p>
      </div>
      <div class="doc-no-box">
        <div class="doc-no-label">No.</div>
        <div class="doc-no-value" id="docNo">-</div>
      </div>
    </div>

    <form id="itRequestForm">
      <div class="question-card">
        <label class="question-label">
          ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á <span class="required">*</span>
        </label>
        <select id="name" name="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á" required>
          <option value="">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</option>
        </select>
      </div>

      <div class="question-card">
        <label class="question-label">
          ‡πÅ‡∏ú‡∏ô‡∏Å‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á <span class="required">*</span>
        </label>
        <input type="text" id="dept" name="‡πÅ‡∏ú‡∏ô‡∏Å‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á"
               placeholder="‡πÅ‡∏ú‡∏ô‡∏Å‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠" readonly required>
      </div>

      <div class="question-card">
        <label class="question-label">‡∏Ç‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</label>
        <div class="options-group">
          <div class="option-item">
            <input type="checkbox" name="equipment" value="Computer Note Book" id="equipNotebook">
            <label for="equipNotebook">Computer Note Book</label>
          </div>
          <div class="option-item">
            <input type="checkbox" name="equipment" value="Computer PC" id="equipPC">
            <label for="equipPC">Computer PC</label>
          </div>
          <div class="option-item">
            <input type="checkbox" name="equipment" value="Soft Ware" id="equipSoft">
            <label for="equipSoft">Soft Ware</label>
          </div>
          <div class="option-item">
            <input type="checkbox" name="equipment" value="Hard Ware" id="equipHard">
            <label for="equipHard">Hard Ware</label>
          </div>
          <div class="option-item">
            <input type="checkbox" id="equipOther">
            <label for="equipOther">‡∏≠‡∏∑‡πà‡∏ô‡πÜ:</label>
            <input type="text" id="equipOtherText" placeholder="‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏">
          </div>
        </div>
      </div>

      <div class="question-card">
        <label class="question-label">‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</label>
        <div class="options-group">
          <div class="option-item">
            <input type="checkbox" name="software" value="Microsoft Office" id="softMS">
            <label for="softMS">Microsoft Office</label>
          </div>
          <div class="option-item">
            <input type="checkbox" name="software" value="Open Office" id="softOpen">
            <label for="softOpen">Open Office</label>
          </div>
          <div class="option-item">
            <input type="checkbox" id="softwareOther">
            <label for="softwareOther">‡∏≠‡∏∑‡πà‡∏ô‡πÜ:</label>
            <input type="text" id="softwareOtherText" placeholder="‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏">
          </div>
        </div>
      </div>

      <!-- üîπ ‡∏ô‡∏≤‡∏°‡∏ö‡∏±‡∏ï‡∏£: Multiple choice (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ï‡∏≠‡∏ö) -->
      <div class="question-card">
        <label class="question-label">‡∏ô‡∏≤‡∏°‡∏ö‡∏±‡∏ï‡∏£</label>
        <div class="options-group">
          <div class="option-item">
            <input type="checkbox" name="businessCard" value="‡∏ô‡∏≤‡∏°‡∏ö‡∏±‡∏ï‡∏£ Digital" id="cardDigital">
            <label for="cardDigital">‡∏ô‡∏≤‡∏°‡∏ö‡∏±‡∏ï‡∏£ Digital</label>
          </div>
          <div class="option-item">
            <input type="checkbox" name="businessCard" value="‡∏ô‡∏≤‡∏°‡∏ö‡∏±‡∏ï‡∏£‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©" id="cardPaper">
            <label for="cardPaper">‡∏ô‡∏≤‡∏°‡∏ö‡∏±‡∏ï‡∏£‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©</label>
          </div>
        </div>
      </div>

      <div class="question-card">
        <label class="question-label">Email</label>
        <input type="email" id="email" name="Email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏≤‡∏°‡∏ö‡∏±‡∏ï‡∏£" readonly>
        <p class="helper-text">
          ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå
        </p>
      </div>

      <div class="question-card">
        <label class="question-label">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô</label>
        <div class="options-group">
          <div class="option-item">
            <input type="radio" name="stationery" value="‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£" id="stationeryYes">
            <label for="stationeryYes">‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</label>
          </div>
          <div class="option-item">
            <input type="radio" name="stationery" value="‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£" id="stationeryNo">
            <label for="stationeryNo">‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</label>
          </div>
        </div>
      </div>

      <div class="question-card">
        <label class="question-label">‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</label>
        <div class="options-group">
          <div class="option-item">
            <input type="radio" name="mobilePhone" value="‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£" id="phoneYes">
            <label for="phoneYes">‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</label>
          </div>
          <div class="option-item">
            <input type="radio" name="mobilePhone" value="‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£" id="phoneNo">
            <label for="phoneNo">‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</label>
          </div>
        </div>
      </div>

      <div class="question-card">
        <label class="question-label">‡∏Å‡∏£‡∏ì‡∏µ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏ö‡∏≠‡∏£‡πå</label>
        <input type="text" id="phoneNumber" name="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏ö‡∏≠‡∏£‡πå" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå">
      </div>

      <div class="question-card">
        <label class="question-label">
          ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏á‡∏≤‡∏ô (‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏) <span class="required">*</span>
        </label>
        <textarea id="purpose" name="‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏á‡∏≤‡∏ô (‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏)"
                  placeholder="‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô" required></textarea>
      </div>

      <div class="question-card">
        <label class="question-label">
          ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° <span class="required">*</span>
        </label>
        <textarea id="reason" name="‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°"
                  placeholder="‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•" required></textarea>
      </div>

      <div class="question-card">
        <label class="question-label">Spec. /Type. /‡∏£‡∏∏‡πà‡∏ô /‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏)</label>
        <textarea id="specs" name="Spec. /Type. /‡∏£‡∏∏‡πà‡∏ô /‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏)"
                  placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡πÄ‡∏õ‡∏Ñ"></textarea>
      </div>

      <div class="question-card">
        <label class="question-label">‡∏£‡∏≤‡∏Ñ‡∏≤ /‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ /‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</label>
        <input type="text" id="budget"
               name="‡∏£‡∏≤‡∏Ñ‡∏≤ /‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ /‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥"
               placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì">
      </div>

      <div class="question-card">
        <label class="question-label">‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label>
        <div class="options-group">
          <div class="option-item">
            <input type="checkbox" name="budgetType"
                   value="‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÄ‡∏ó‡πà‡∏≤‡πÅ‡∏ó‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Å‡πà‡∏≤" id="budgetReplace">
            <label for="budgetReplace">‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÄ‡∏ó‡πà‡∏≤‡πÅ‡∏ó‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Å‡πà‡∏≤</label>
          </div>
          <div class="option-item">
            <input type="checkbox" name="budgetType"
                   value="‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì" id="budgetNone">
            <label for="budgetNone">‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label>
          </div>
          <div class="option-item">
            <input type="checkbox" id="budgetTypeOther">
            <label for="budgetTypeOther">‡∏≠‡∏∑‡πà‡∏ô‡πÜ:</label>
            <input type="text" id="budgetTypeOtherText" placeholder="‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏">
          </div>
        </div>
      </div>

      <!-- üîπ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö: required -->
      <div class="question-card">
        <label class="question-label">
          ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö <span class="required">*</span>
        </label>
        <input type="date" id="deliveryDate" name="‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö" required>
      </div>

      <div class="question-card">
        <div class="signature-section">
          <h3>‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á <span class="required">*</span></h3>
          <canvas id="signatureCanvas" width="800" height="200"></canvas>
          <button type="button" class="btn-clear" onclick="clearSignature()">
            ‡∏•‡πâ‡∏≤‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô
          </button>
        </div>
      </div>

      <div class="question-card">
        <div class="button-group">
          <button type="submit" class="btn-submit" id="submitBtn">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠</button>
        </div>
        <div id="status"></div>
      </div>
    </form>
  </div>

  <script>
    // ================================
    // CONFIG
    // ================================
    const CONFIG = {
      APPS_SCRIPT_URL: 'https://script.google.com/macros/s/AKfycbwAL1ISDOIC_0TVh4RZniHn34vP0O7x5yBHlyxGZ1-u8ctgEg9OtG9dNMAZwxH7sNww/exec'
    };

    // ================================
    // Prefill ‡∏à‡∏≤‡∏Å URL
    // ================================
    const urlParams = new URLSearchParams(window.location.search);
    const prefillData = {
      name:        urlParams.get('name')        || '',
      dept:        urlParams.get('dept')        || '',
      email:       urlParams.get('email')       || '',
      purpose:     urlParams.get('purpose')     || '',
      candidateEn: urlParams.get('candidateEn') || ''
    };
    console.log('üì• Prefill Data:', prefillData);

    // ================================
    // Signature Canvas
    // ================================
    let canvas, ctx, isDrawing = false, hasSignature = false;

    function initCanvas() {
      canvas = document.getElementById('signatureCanvas');
      ctx = canvas.getContext('2d');

      // ‡πÄ‡∏ï‡∏¥‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß (‡∏Å‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™‡∏ï‡∏≠‡∏ô export)
      ctx.fillStyle = '#ffffff';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.strokeStyle = '#000000';
      ctx.lineWidth = 2;
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';

      // mouse events
      canvas.addEventListener('mousedown', startDrawing);
      canvas.addEventListener('mousemove', draw);
      canvas.addEventListener('mouseup', stopDrawing);
      canvas.addEventListener('mouseleave', stopDrawing);

      // touch events
      canvas.addEventListener('touchstart', handleTouch);
      canvas.addEventListener('touchmove', handleTouch);
      canvas.addEventListener('touchend', handleTouch);
    }

    // map ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏°‡∏≤‡∏™‡πå/‡∏ô‡∏¥‡πâ‡∏ß‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á canvas (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô review.html)
    function getCanvasPos(e) {
      const rect   = canvas.getBoundingClientRect();
      const scaleX = canvas.width  / rect.width;
      const scaleY = canvas.height / rect.height;
      return {
        x: (e.clientX - rect.left) * scaleX,
        y: (e.clientY - rect.top)  * scaleY
      };
    }

    function startDrawing(e) {
      e.preventDefault();
      isDrawing = true;
      hasSignature = true;

      const pos = getCanvasPos(e);
      ctx.beginPath();
      ctx.moveTo(pos.x, pos.y);
    }

    function draw(e) {
      if (!isDrawing) return;
      e.preventDefault();

      const pos = getCanvasPos(e);
      ctx.lineTo(pos.x, pos.y);
      ctx.stroke();
    }

    function stopDrawing(e) {
      if (e) e.preventDefault();
      isDrawing = false;
    }

    function handleTouch(e) {
      e.preventDefault();
      const touch = e.touches[0] || e.changedTouches[0];
      if (!touch) return;

      const type =
        e.type === 'touchstart' ? 'mousedown' :
        e.type === 'touchmove'  ? 'mousemove' :
                                  'mouseup';

      const mouseEvent = new MouseEvent(type, {
        clientX: touch.clientX,
        clientY: touch.clientY,
        bubbles: true,
        cancelable: true
      });
      canvas.dispatchEvent(mouseEvent);
    }

    function clearSignature() {
      // ‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ç‡∏≤‡∏ß‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏´‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏°‡πà‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = '#ffffff';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      hasSignature = false;
    }

    // ================================
    // Status helper
    // ================================
    let hrMasterData = [];

    function showStatus(message, type = 'info') {
      const statusDiv = document.getElementById('status');
      statusDiv.textContent = message;
      statusDiv.className = type;
      statusDiv.style.display = 'block';
      if (type === 'success' || type === 'error') {
        setTimeout(() => statusDiv.style.display = 'none', 5000);
      }
    }

    // ================================
    // JSONP: HR Master Data
    // ================================
    function loadHRMasterData() {
      showStatus('‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô...', 'loading');

      const callbackName = 'hrDataCallback_' + Date.now();
      window[callbackName] = function(result) {
        console.log('üìä HR Master Data:', result);

        if (result.success && result.data) {
          hrMasterData = result.data;
          populateRequesterDropdown();
          applyPrefillData();
          showStatus('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (' + hrMasterData.length + ' ‡∏Ñ‡∏ô)', 'success');
        } else {
          showStatus('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: ' + (result.message || ''), 'error');
        }

        // Cleanup
        try {
          const scripts = document.head.getElementsByTagName('script');
          for (let i = 0; i < scripts.length; i++) {
             if (scripts[i].src.includes(callbackName)) {
                 document.head.removeChild(scripts[i]);
             }
          }
        } catch(e) {}
        delete window[callbackName];
      };

      const script = document.createElement('script');
      script.src = CONFIG.APPS_SCRIPT_URL +
                   '?action=getHRMasterData' +
                   '&callback=' + callbackName;

      script.onerror = function() {
        showStatus('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
        delete window[callbackName];
      };

      document.head.appendChild(script);
    }

    // ================================
    // JSONP: Next Doc No.
    // ================================
    function loadDocNo() {
      const docNoEl = document.getElementById('docNo');
      if (docNoEl) docNoEl.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...';

      const callbackName = 'docNoCallback_' + Date.now();
      window[callbackName] = function(result) {
        console.log('üìÑ Next Doc No:', result);
        if (result && result.success && result.docNo && docNoEl) {
          docNoEl.textContent = result.docNo;
        } else if (docNoEl) {
          docNoEl.textContent = '-';
        }
        
        try {
            const scripts = document.head.getElementsByTagName('script');
            for (let i = 0; i < scripts.length; i++) {
                if (scripts[i].src.includes(callbackName)) {
                    document.head.removeChild(scripts[i]);
                }
            }
        } catch(e) {}
        delete window[callbackName];
      };

      const script = document.createElement('script');
      script.src = CONFIG.APPS_SCRIPT_URL +
                   '?action=getNextDocNo' +
                   '&callback=' + callbackName;

      script.onerror = function() {
        console.error('‚ùå Error loading next doc no.');
        if (docNoEl) docNoEl.textContent = '-';
        delete window[callbackName];
      };

      document.head.appendChild(script);
    }

    // ================================
    // Populate dropdown ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á
    // ================================
    function populateRequesterDropdown() {
      const select = document.getElementById('name');
      select.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á --</option>';
      hrMasterData.forEach((person, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = person.name;
        select.appendChild(option);
      });
    }

    // ================================
    // Apply Prefill
    // ================================
    function applyPrefillData() {
      if (prefillData.name) {
        const matchedIndex = hrMasterData.findIndex(
          person => person.name === prefillData.name
        );
        if (matchedIndex !== -1) {
          document.getElementById('name').value = matchedIndex;
          document.getElementById('dept').value =
            hrMasterData[matchedIndex].dept || '';
          console.log('‚úÖ Auto-selected requester:', hrMasterData[matchedIndex].name);
        }
      }

      if (prefillData.purpose) {
        document.getElementById('purpose').value = prefillData.purpose;
      }

      // ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏ú‡∏π‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á email
      if (prefillData.candidateEn) {
        const email = generateEmailFromName(prefillData.candidateEn);
        document.getElementById('email').value = email;
        console.log('‚úÖ Candidate email:', prefillData.candidateEn, '‚Üí', email);
      } else if (prefillData.email) {
        // fallback ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ email ‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡∏ï‡∏£‡∏á‡∏°‡∏≤
        document.getElementById('email').value = prefillData.email;
      }
    }

    // ================================
    // Event Listeners
    // ================================
    
    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á ‚Üí ‡πÄ‡∏ï‡∏¥‡∏°‡πÅ‡∏ú‡∏ô‡∏Å
    document.getElementById('name').addEventListener('change', function() {
      const index = parseInt(this.value);
      if (isNaN(index) || index < 0) {
        document.getElementById('dept').value = '';
        return;
      }
      const person = hrMasterData[index];
      document.getElementById('dept').value = person.dept || '';
    });

    // ================================
    // Generate Email (‡∏ä‡∏∑‡πà‡∏≠ EN + 2 ‡∏ï‡∏±‡∏ß‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•)
    // ================================
    function generateEmailFromName(fullNameEN) {
      if (!fullNameEN) return '';
      const parts = fullNameEN.trim().split(/\s+/);
      if (parts.length < 2)
        return fullNameEN.toLowerCase() + '@carpetmaker.co.th';

      const firstName = parts[0].toLowerCase();
      const lastName  = parts[parts.length - 1].toLowerCase();
      const lastPrefix = lastName.substring(0, 2);
      return firstName + lastPrefix + '@carpetmaker.co.th';
    }

    // ================================
    // Submit Form
    // ================================
    document.getElementById('itRequestForm').addEventListener('submit', function(e) {
      e.preventDefault();

      if (!hasSignature) {
        showStatus('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ß‡∏≤‡∏î‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°', 'error');
        document.getElementById('signatureCanvas')
                .scrollIntoView({ behavior: 'smooth' });
        return;
      }

      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<span class="spinner"></span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
      showStatus('‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...', 'loading');

      const formData = collectFormData();
      console.log('üì¶ Form Data:', formData);

      const params = new URLSearchParams();
      for (const key in formData) params.append(key, formData[key]);

      fetch(CONFIG.APPS_SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors',
        body: params,
        redirect: 'follow'
      })
      .then(() => {
        showStatus('‚úÖ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!', 'success');
        setTimeout(() => {
          document.getElementById('itRequestForm').reset();
          clearSignature();
          submitBtn.disabled = false;
          submitBtn.innerHTML = '‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠';
          loadHRMasterData();
          loadDocNo();
        }, 2000);
      })
      .catch(err => {
        console.error('‚ùå Submit Error:', err);
        showStatus('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + err.message, 'error');
        submitBtn.disabled = false;
        submitBtn.innerHTML = '‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠';
      });
    });

    // ================================
    // Collect Form Data
    // ================================
    function collectFormData() {
      const formData = {};
      const nameSelect = document.getElementById('name');
      const selectedIndex = parseInt(nameSelect.value);

      if (!isNaN(selectedIndex) && selectedIndex >= 0) {
        formData['‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á'] = hrMasterData[selectedIndex].name;
      }

      formData['Email'] = document.getElementById('email').value || '';
      formData['‡πÅ‡∏ú‡∏ô‡∏Å‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á'] = document.getElementById('dept').value;
      formData['‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏á‡∏≤‡∏ô (‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏)'] =
        document.getElementById('purpose').value;

      const equipment = [];
      document.querySelectorAll('input[name="equipment"]:checked')
        .forEach(cb => equipment.push(cb.value));
      if (document.getElementById('equipOther').checked) {
        const t = document.getElementById('equipOtherText').value;
        if (t) equipment.push(t);
      }
      formData['‡∏Ç‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå'] = equipment.join(', ');

      const software = [];
      document.querySelectorAll('input[name="software"]:checked')
        .forEach(cb => software.push(cb.value));
      if (document.getElementById('softwareOther').checked) {
        const t = document.getElementById('softwareOtherText').value;
        if (t) software.push(t);
      }
      formData['‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô'] = software.join(', ');

      const businessCards = [];
      document.querySelectorAll('input[name="businessCard"]:checked')
        .forEach(cb => businessCards.push(cb.value));
      formData['‡∏ô‡∏≤‡∏°‡∏ö‡∏±‡∏ï‡∏£'] = businessCards.join(', ');

      const stationery = document.querySelector('input[name="stationery"]:checked');
      formData['‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô'] = stationery ? stationery.value : '';

      const mobilePhone = document.querySelector('input[name="mobilePhone"]:checked');
      formData['‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠'] = mobilePhone ? mobilePhone.value : '';
      formData['‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏ö‡∏≠‡∏£‡πå'] = document.getElementById('phoneNumber').value || '';

      formData['‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°'] = document.getElementById('reason').value;
      formData['Spec. /Type. /‡∏£‡∏∏‡πà‡∏ô /‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏)'] =
        document.getElementById('specs').value;
      formData['‡∏£‡∏≤‡∏Ñ‡∏≤ /‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ /‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥'] =
        document.getElementById('budget').value;

      const budgetTypes = [];
      document.querySelectorAll('input[name="budgetType"]:checked')
        .forEach(cb => budgetTypes.push(cb.value));
      if (document.getElementById('budgetTypeOther').checked) {
        const t = document.getElementById('budgetTypeOtherText').value;
        if (t) budgetTypes.push(t);
      }
      formData['‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì'] = budgetTypes.join(', ');

      formData['‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö'] = document.getElementById('deliveryDate').value;
      formData['requesterSignature'] = canvas.toDataURL('image/png');
      formData['Time'] = new Date().toISOString();
      formData['No.'] = document.getElementById('docNo')?.textContent || '';

      return formData;
    }

    // ================================
    // Init
    // ================================
    window.addEventListener('DOMContentLoaded', () => {
      console.log('üöÄ Initializing IT Request Form...');
      initCanvas();
      loadHRMasterData();
      loadDocNo();
    });
  </script>
</body>
</html>