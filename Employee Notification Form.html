<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Sarabun", "Segoe UI", Tahoma, sans-serif;
      background: radial-gradient(circle at top left, #a855f7 0, #4f46e5 40%, #111827 100%);
      min-height: 100vh;
      padding: 24px;
      color: #111827;
    }

    .page-container {
      max-width: 1200px;
      margin: 0 auto;
      background: #f9fafb;
      border-radius: 18px;
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.35);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .page-header {
      padding: 18px 24px;
      border-bottom: 1px solid #e5e7eb;
      background: linear-gradient(90deg, #4f46e5, #6366f1);
      color: white;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .page-header-title {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .page-header-title span.emoji {
      font-size: 26px;
    }

    .page-header h1 {
      font-size: 20px;
      font-weight: 600;
    }

    .page-header small {
      display: block;
      font-size: 12px;
      opacity: 0.9;
    }

    .page-header-right {
      font-size: 12px;
      text-align: right;
      opacity: 0.95;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 3.2fr) minmax(260px, 1.8fr);
      gap: 0;
    }

    .left-pane {
      padding: 20px 24px 24px;
      border-right: 1px solid #e5e7eb;
      background: white;
    }

    .right-pane {
      padding: 20px 20px 24px;
      background: #f3f4ff;
    }

    .section-title-main {
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
      color: #111827;
    }

    .section-title-main .emoji {
      font-size: 22px;
    }

    .subtitle {
      font-size: 12px;
      color: #6b7280;
      margin-bottom: 18px;
    }

    .card {
      background: #f9fafb;
      border-radius: 14px;
      border: 1px solid #e5e7eb;
      padding: 16px 18px;
      margin-bottom: 16px;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .section-title {
      font-size: 14px;
      font-weight: 600;
      color: #111827;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .section-title::before {
      content: "";
      display: inline-block;
      width: 4px;
      height: 14px;
      border-radius: 999px;
      background: #4f46e5;
    }

    .section-sub {
      font-size: 11px;
      color: #6b7280;
    }

    .field-row {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px 14px;
      margin-bottom: 10px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 13px;
    }

    label {
      font-size: 12px;
      color: #374151;
    }

    label span.required {
      color: #ef4444;
      margin-left: 2px;
    }

    input[type="text"],
    input[type="date"],
    select,
    textarea {
      width: 100%;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      background: #f9fafb;
      font-size: 13px;
      outline: none;
      transition: border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    }

    textarea {
      border-radius: 12px;
      resize: vertical;
    }

    input:focus,
    select:focus,
    textarea:focus {
      border-color: #4f46e5;
      box-shadow: 0 0 0 1px rgba(79, 70, 229, 0.2);
      background: #ffffff;
    }

    input[readonly] {
      background: #f3f4f6;
      cursor: default;
    }

    .employee-source-note {
      font-size: 11px;
      color: #6b7280;
      margin-top: 2px;
    }

    .radio-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 13px;
    }

    .radio-item {
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .radio-item input[type="radio"] {
      margin-top: 3px;
    }

    .radio-item label {
      font-size: 13px;
      cursor: pointer;
    }

    .actions-row {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      margin-top: 10px;
    }

    .btn {
      border-radius: 999px;
      padding: 8px 18px;
      font-size: 13px;
      font-weight: 500;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .btn-primary {
      background: linear-gradient(90deg, #4f46e5, #6366f1);
      color: white;
      box-shadow: 0 10px 25px rgba(79, 70, 229, 0.45);
    }

    .btn-secondary {
      background: #e5e7eb;
      color: #111827;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: default;
      box-shadow: none;
    }

    /* ===== RIGHT PREVIEW ===== */
    .preview-title {
      font-size: 14px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
      color: #111827;
    }

    .preview-title .emoji {
      font-size: 20px;
    }

    .preview-card {
      background: white;
      border-radius: 14px;
      border: 1px solid #e5e7eb;
      padding: 14px 16px;
      margin-bottom: 12px;
      font-size: 12px;
    }

    .preview-row {
      margin-bottom: 6px;
    }

    .preview-label {
      color: #6b7280;
      margin-bottom: 2px;
    }

    .preview-value {
      font-weight: 500;
      color: #111827;
    }

    .preview-divider {
      height: 1px;
      background: #e5e7eb;
      margin: 8px 0;
    }

    .preview-empty {
      font-size: 12px;
      color: #9ca3af;
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 11px;
      background: #eef2ff;
      color: #4338ca;
      border: 1px solid #c7d2fe;
    }

    .status-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #22c55e;
    }

    /* ===== FROM / TO layout ===== */
    .fromto-row {
      display: grid;
      grid-template-columns: auto minmax(0, 1fr) auto minmax(0, 1fr);
      column-gap: 10px;
      row-gap: 6px;
      align-items: center;
      margin-bottom: 8px;
    }

    .single-to-row {
      grid-template-columns: auto minmax(0, 1fr);
    }

    .fromto-label {
      font-size: 13px;
      white-space: nowrap;
    }

    .fromto-label.to {
      text-align: right;
    }

    .fromto-input {
      width: 100%;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background-color: #f9fafb;
      font-size: 13px;
      outline: none;
    }

    .fromto-input:focus,
    .fromto-textarea:focus {
      border-color: #6366f1;
      box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.15);
      background: #ffffff;
    }

    .fromto-textarea {
      width: 100%;
      margin-top: 4px;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background-color: #f9fafb;
      resize: vertical;
      font-size: 13px;
    }

    .other-detail-block {
      margin-top: 12px;
    }

    .small-note {
      font-size: 11px;
      color: #9ca3af;
      margin-top: 4px;
    }

    @media (max-width: 900px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
      .left-pane {
        border-right: none;
        border-bottom: 1px solid #e5e7eb;
      }
    }
  </style>
</head>
<body>
  <div class="page-container">
    <header class="page-header">
      <div class="page-header-title">
        <span class="emoji">üìù</span>
        <div>
          <h1>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (HR Document)</h1>
          <small>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≤‡∏Å HRD demo ‡πÅ‡∏•‡∏∞ ‡∏ú‡∏π‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå</small>
        </div>
      </div>
      <div class="page-header-right">
        <div class="status-badge">
          <span class="status-dot"></span>
          <span id="statusText">‡∏£‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
        </div>
        <div style="margin-top:4px;">‡πÑ‡∏ü‡∏•‡πå: HRD demo</div>
      </div>
    </header>

    <div class="layout">
      <!-- ============ LEFT FORM ============ -->
      <div class="left-pane">
        <div class="section-title-main">
          <span class="emoji">üìÑ</span>
          <span>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</span>
        </div>
        <p class="subtitle">
          ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ï <strong>"‡∏ú‡∏π‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå"</strong> ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏û‡∏£‡∏µ‡∏ü‡∏¥‡∏•‡πÉ‡∏´‡πâ ‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ‡πÅ‡∏ú‡∏ô‡∏Å ‡∏ù‡πà‡∏≤‡∏¢ ‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô ‡∏Ø‡∏•‡∏Ø
        </p>

        <!-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô -->
        <div class="card">
          <div class="section-header">
            <div>
              <div class="section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</div>
              <div class="section-sub">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ï "‡∏ú‡∏π‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå"</div>
            </div>
          </div>

          <div class="field">
            <label for="employeeSelect">‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô <span class="required">*</span></label>
            <select id="employeeSelect">
              <option value="">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô...</option>
            </select>
            <div class="employee-source-note">
              ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ï "‡∏ú‡∏π‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå" ‡πÉ‡∏ô HRD demo (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•)
            </div>
          </div>
        </div>

        <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô -->
        <div class="card">
          <div class="section-header">
            <div>
              <div class="section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
              <div class="section-sub">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
            </div>
          </div>

          <div class="field-row">
            <div class="field">
              <label for="empCode">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô <span class="required">*</span></label>
              <input type="text" id="empCode" readonly />
            </div>
            <div class="field">
              <label for="startDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô <span class="required">*</span></label>
              <input type="date" id="startDate" />
            </div>
          </div>

          <div class="field-row">
            <div class="field">
              <label for="position">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô <span class="required">*</span></label>
              <input type="text" id="position" />
            </div>
            <div class="field">
              <label for="dept">‡πÅ‡∏ú‡∏ô‡∏Å <span class="required">*</span></label>
              <input type="text" id="dept" />
            </div>
          </div>

          <div class="field-row">
            <div class="field">
              <label for="division">‡∏ù‡πà‡∏≤‡∏¢ <span class="required">*</span></label>
              <input type="text" id="division" />
            </div>
            <div class="field">
              <label for="employmentType">‡∏™‡∏†‡∏≤‡∏û‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô <span class="required">*</span></label>
              <input type="text" id="employmentType" />
              <div class="small-note">‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ï "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏ú‡∏π‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå" ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡πà‡∏ù‡∏±‡πà‡∏á Server ‡πÉ‡∏ä‡πâ map</div>
            </div>
          </div>
        </div>

        <!-- ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ -->
        <div class="card">
          <div class="section-header">
            <div>
              <div class="section-title">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
              <div class="section-sub">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÉ‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</div>
            </div>
          </div>

          <div class="radio-list" id="actionTypeGroup">
            <div class="radio-item">
              <input type="radio" name="actionType" id="act_appoint" value="appoint" />
              <label for="act_appoint">‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á</label>
            </div>
            <div class="radio-item">
              <input type="radio" name="actionType" id="act_transfer" value="transfer" />
              <label for="act_transfer">‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢</label>
            </div>
            <div class="radio-item">
              <input type="radio" name="actionType" id="act_change" value="change" />
              <label for="act_change">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô</label>
            </div>
            <div class="radio-item">
              <input type="radio" name="actionType" id="act_promote" value="promote" />
              <label for="act_promote">‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
            </div>
            <div class="radio-item">
              <input type="radio" name="actionType" id="act_passProb" value="pass_probation" />
              <label for="act_passProb">‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏á‡∏≤‡∏ô</label>
            </div>
            <div class="radio-item">
              <input type="radio" name="actionType" id="act_terminate" value="terminate" />
              <label for="act_terminate">‡πÉ‡∏´‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏à / ‡∏•‡∏≤‡∏≠‡∏≠‡∏Å</label>
            </div>
            <div class="radio-item">
              <input type="radio" name="actionType" id="act_increase" value="increase" />
              <label for="act_increase">‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á / ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</label>
            </div>
            <div class="radio-item">
              <input type="radio" name="actionType" id="act_cut" value="cut" />
              <label for="act_cut">‡∏ï‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á / ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</label>
            </div>
            <div class="radio-item">
              <input type="radio" name="actionType" id="act_other" value="other" />
              <label for="act_other">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</label>
            </div>
          </div>
        </div>

        <!-- ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î From / To -->
        <div class="card section-card">
          <div class="section-header">
            <div>
              <div class="section-title">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
              <div class="section-sub">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©: ‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏° (From) ‚Üí ‡πÄ‡∏õ‡πá‡∏ô (To)</div>
            </div>
          </div>

          <div id="action-detail-wrapper">
            <!-- ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ö‡∏ô‡∏™‡∏∏‡∏î : ‡πÄ‡∏õ‡πá‡∏ô (To) -->
            <div class="fromto-row single-to-row">
              <label class="fromto-label">‡πÄ‡∏õ‡πá‡∏ô (To)</label>
              <input type="text" id="action_to_main" name="action_to_main" class="fromto-input" />
            </div>

            <!-- ‡πÅ‡∏ñ‡∏ß 1 -->
            <div class="fromto-row">
              <label class="fromto-label">‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏° (From)</label>
              <input type="text" id="action_from_1" name="action_from_1" class="fromto-input" />
              <label class="fromto-label to">‡πÄ‡∏õ‡πá‡∏ô (To)</label>
              <input type="text" id="action_to_1" name="action_to_1" class="fromto-input" />
            </div>

            <!-- ‡πÅ‡∏ñ‡∏ß 2 -->
            <div class="fromto-row">
              <label class="fromto-label">‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏° (From)</label>
              <input type="text" id="action_from_2" name="action_from_2" class="fromto-input" />
              <label class="fromto-label to">‡πÄ‡∏õ‡πá‡∏ô (To)</label>
              <input type="text" id="action_to_2" name="action_to_2" class="fromto-input" />
            </div>

            <!-- ‡πÅ‡∏ñ‡∏ß 3 -->
            <div class="fromto-row">
              <label class="fromto-label">‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏° (From)</label>
              <input type="text" id="action_from_3" name="action_from_3" class="fromto-input" />
              <label class="fromto-label to">‡πÄ‡∏õ‡πá‡∏ô (To)</label>
              <input type="text" id="action_to_3" name="action_to_3" class="fromto-input" />
            </div>

            <!-- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° -->
            <div class="other-detail-block">
              <label for="action_other_detail" class="fromto-label">
                ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° / ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á
              </label>
              <textarea
                id="action_other_detail"
                name="action_other_detail"
                rows="3"
                class="fromto-textarea"
                placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß, ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏à‡πâ‡∏≤‡∏á, ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏∑‡πà‡∏ô ‡πÜ"
              ></textarea>
            </div>
          </div>
        </div>

        <!-- ‡∏õ‡∏∏‡πà‡∏° -->
        <div class="actions-row">
          <button type="button" class="btn btn-secondary" onclick="window.location.reload()">‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤</button>
          <button type="button" class="btn btn-primary" id="submitBtn" onclick="handleSubmit()">
            ‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
          </button>
        </div>
      </div>

      <!-- ============ RIGHT PREVIEW ============ -->
      <div class="right-pane">
        <div class="preview-title">
          <span class="emoji">üëÅÔ∏è</span>
          <span>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</span>
        </div>

        <div class="preview-card">
          <div class="preview-row">
            <div class="preview-label">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</div>
            <div class="preview-value" id="pvEmpName">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</div>
          </div>
          <div class="preview-row">
            <div class="preview-label">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô / ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</div>
            <div class="preview-value" id="pvEmpCodePos">-</div>
          </div>
          <div class="preview-row">
            <div class="preview-label">‡πÅ‡∏ú‡∏ô‡∏Å / ‡∏ù‡πà‡∏≤‡∏¢</div>
            <div class="preview-value" id="pvDeptDiv">-</div>
          </div>
          <div class="preview-row">
            <div class="preview-label">‡∏™‡∏†‡∏≤‡∏û‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô / ‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</div>
            <div class="preview-value" id="pvEmpTypeStart">-</div>
          </div>

          <div class="preview-divider"></div>

          <div class="preview-row">
            <div class="preview-label">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
            <div class="preview-value" id="pvActionType">-</div>
          </div>
          <div class="preview-row">
            <div class="preview-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î From / To</div>
            <div class="preview-value" id="pvActionDetail">
              <span class="preview-empty">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</span>
            </div>
          </div>
          <div class="preview-row">
            <div class="preview-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</div>
            <div class="preview-value" id="pvOtherDetail">
              <span class="preview-empty">-</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // üëâ ‡πÅ‡∏Å‡πâ‡πÄ‡∏õ‡πá‡∏ô URL Web App ‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á UnifiedWebApp.gs
    const WEB_APP_URL = 'https://script.google.com/macros/s/PUT_YOUR_DEPLOYMENT_ID_HERE/exec';

    let EMP_LIST = []; // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏≤‡∏Å Server

    function getQueryParam(name) {
      const url = new URL(window.location.href);
      return url.searchParams.get(name) || '';
    }

    // ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (JSONP)
    function loadEmployees() {
      const script = document.createElement('script');
      const cbName = 'onEmployeesLoaded';
      const url = WEB_APP_URL + '?action=getEmployees&callback=' + cbName;
      script.src = url;
      document.body.appendChild(script);
    }

    // callback ‡∏à‡∏≤‡∏Å JSONP
    function onEmployeesLoaded(res) {
      const select = document.getElementById('employeeSelect');
      select.innerHTML = '';

      if (!res || !res.success || !Array.isArray(res.data) || res.data.length === 0) {
        const opt = document.createElement('option');
        opt.value = '';
        opt.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ï "‡∏ú‡∏π‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå"';
        select.appendChild(opt);
        select.disabled = true;
        return;
      }

      EMP_LIST = res.data;

      const placeholder = document.createElement('option');
      placeholder.value = '';
      placeholder.textContent = '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô...';
      select.appendChild(placeholder);

      EMP_LIST.forEach(emp => {
        const opt = document.createElement('option');
        opt.value = emp.id;
        opt.textContent = emp.name;
        opt.dataset.code = emp.code || '';
        select.appendChild(opt);
      });

      // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ query ?name=... ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏¢
      const qName = getQueryParam('name');
      if (qName) {
        const found = EMP_LIST.find(e => (e.name || '').trim() === qName.trim());
        if (found) {
          select.value = found.id;
          fillEmployee(found);
        }
      }
    }

    function fillEmployee(emp) {
      document.getElementById('empCode').value = emp.code || '';
      document.getElementById('position').value = emp.position || '';
      document.getElementById('dept').value = emp.department || '';
      document.getElementById('division').value = emp.division || '';
      document.getElementById('employmentType').value = emp.employmentType || '';

      if (emp.startDate) {
        const d = new Date(emp.startDate);
        if (!isNaN(d.getTime())) {
          const iso = d.toISOString().slice(0, 10);
          document.getElementById('startDate').value = iso;
        }
      }

      updatePreview();
    }

    function onEmployeeChange() {
      const select = document.getElementById('employeeSelect');
      const id = select.value;
      const emp = EMP_LIST.find(e => String(e.id) === String(id));
      if (!emp) {
        return;
      }
      fillEmployee(emp);
    }

    function onActionTypeChange() {
      updatePreview();
    }

    function updatePreview() {
      const empSelect = document.getElementById('employeeSelect');
      const empName = empSelect.options[empSelect.selectedIndex]?.text || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å';
      const empCode = document.getElementById('empCode').value || '-';
      const position = document.getElementById('position').value || '-';
      const dept = document.getElementById('dept').value || '-';
      const division = document.getElementById('division').value || '-';
      const empType = document.getElementById('employmentType').value || '-';
      const startDate = document.getElementById('startDate').value || '-';

      document.getElementById('pvEmpName').textContent = empName;
      document.getElementById('pvEmpCodePos').textContent = empCode + ' / ' + position;
      document.getElementById('pvDeptDiv').textContent = dept + ' / ' + division;
      document.getElementById('pvEmpTypeStart').textContent = empType + ' / ' + startDate;

      // action type text
      const act = document.querySelector('input[name="actionType"]:checked');
      let actText = '-';
      if (act) {
        const map = {
          appoint: '‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á',
          transfer: '‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢',
          change: '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô',
          promote: '‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á',
          pass_probation: '‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏á‡∏≤‡∏ô',
          terminate: '‡πÉ‡∏´‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏à / ‡∏•‡∏≤‡∏≠‡∏≠‡∏Å',
          increase: '‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á / ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
          cut: '‡∏ï‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á / ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
          other: '‡∏≠‡∏∑‡πà‡∏ô ‡πÜ'
        };
        actText = map[act.value] || act.value;
      }
      document.getElementById('pvActionType').textContent = actText;

      // from/to detail
      const lines = [];
      const mainTo = document.getElementById('action_to_main').value.trim();
      if (mainTo) lines.push('‡πÄ‡∏õ‡πá‡∏ô (To): ' + mainTo);

      for (let i = 1; i <= 3; i++) {
        const from = document.getElementById('action_from_' + i).value.trim();
        const to = document.getElementById('action_to_' + i).value.trim();
        if (from || to) {
          lines.push(`‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏° (From): ${from || '-'} ‚Üí ‡πÄ‡∏õ‡πá‡∏ô (To): ${to || '-'}`);
        }
      }

      const pvDetail = document.getElementById('pvActionDetail');
      pvDetail.innerHTML = '';
      if (lines.length === 0) {
        pvDetail.innerHTML = '<span class="preview-empty">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</span>';
      } else {
        lines.forEach(l => {
          const div = document.createElement('div');
          div.textContent = l;
          pvDetail.appendChild(div);
        });
      }

      const other = document.getElementById('action_other_detail').value.trim();
      const pvOther = document.getElementById('pvOtherDetail');
      if (!other) {
        pvOther.innerHTML = '<span class="preview-empty">-</span>';
      } else {
        pvOther.textContent = other;
      }

      const statusText = document.getElementById('statusText');
      if (empSelect.value) {
        statusText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£';
      } else {
        statusText.textContent = '‡∏£‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
      }
    }

    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Apps Script (‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô log + template)
    function handleSubmit() {
      updatePreview();

      const empSelect = document.getElementById('employeeSelect');
      if (!empSelect.value) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô');
        return;
      }

      const act = document.querySelector('input[name="actionType"]:checked');
      if (!act) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£');
        return;
      }

      const payload = {
        action: 'createDocument', // ‡πÉ‡∏´‡πâ‡∏ù‡∏±‡πà‡∏á Apps Script HRDocumentSystem ‡∏£‡∏±‡∏ö action ‡∏ô‡∏µ‡πâ
        empId: empSelect.value,
        empName: empSelect.options[empSelect.selectedIndex].text,
        empCode: document.getElementById('empCode').value,
        position: document.getElementById('position').value,
        dept: document.getElementById('dept').value,
        division: document.getElementById('division').value,
        employmentType: document.getElementById('employmentType').value,
        startDate: document.getElementById('startDate').value,
        actionType: act.value,
        action_to_main: document.getElementById('action_to_main').value,
        action_from_1: document.getElementById('action_from_1').value,
        action_to_1: document.getElementById('action_to_1').value,
        action_from_2: document.getElementById('action_from_2').value,
        action_to_2: document.getElementById('action_to_2').value,
        action_from_3: document.getElementById('action_from_3').value,
        action_to_3: document.getElementById('action_to_3').value,
        otherDetail: document.getElementById('action_other_detail').value
      };

      console.log('Submit payload:', payload);

      // ‡∏ñ‡πâ‡∏≤ Apps Script ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö doPost JSON ‡πÅ‡∏•‡πâ‡∏ß ‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ
      /*
      const btn = document.getElementById('submitBtn');
      btn.disabled = true;
      btn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';

      fetch(WEB_APP_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      })
        .then(res => res.json())
        .then(data => {
          console.log('Server result', data);
          alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£: ' + (data.docNumber || '-'));
        })
        .catch(err => {
          console.error(err);
          alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å');
        })
        .finally(() => {
          btn.disabled = false;
          btn.textContent = '‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£';
        });
      */
      alert('‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö - payload ‡∏ñ‡∏π‡∏Å log ‡πÉ‡∏ô Console ‡πÅ‡∏•‡πâ‡∏ß');
    }

    // event listeners
    document.getElementById('employeeSelect').addEventListener('change', onEmployeeChange);
    document.getElementById('startDate').addEventListener('change', updatePreview);
    document.getElementById('position').addEventListener('input', updatePreview);
    document.getElementById('dept').addEventListener('input', updatePreview);
    document.getElementById('division').addEventListener('input', updatePreview);
    document.getElementById('employmentType').addEventListener('input', updatePreview);

    document.querySelectorAll('input[name="actionType"]').forEach(el => {
      el.addEventListener('change', onActionTypeChange);
    });

    ['action_to_main', 'action_from_1', 'action_to_1', 'action_from_2', 'action_to_2', 'action_from_3', 'action_to_3', 'action_other_detail']
      .forEach(id => {
        document.getElementById(id).addEventListener('input', updatePreview);
      });

    // init
    loadEmployees();
  </script>
</body>
</html>
